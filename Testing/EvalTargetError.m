
% RasPoints

% %fCal
% RasPoints = [
%     79.985 14.982 4.859 1;
%     79.986 15.131 45.025 1;
%     39.986 15.228 45.000 1;
%     39.969 14.955 4.916 1;
%     ];

% %Lumbar
% RasPoints = [
%     -12.301 -76.522 103.032 1;
%     -11.578 -78.14 71.165 1;
%     -11.135 -76.803 35.946 1;
%     -9.948 -74.632 6.635 1;
%     ];

%LEGO
RasPoints = [
    31.813 -0.320 11.022 1;
    31.825 39.986 10.326 1;
    47.993 39.872 0.967 1;
    48.002 -0.434 1.704 1;
    ];

% RefPoints

% %fCal
% RefPoints = [
%     -0.852 -31.289 -2.674 1;
%     -0.402 -32.167 37.674 1;
%     -1.008 -72.434 36.630 1;
%     -1.118 -71.685 -2.623 1;
%     ];


% %Lumbar
% RefPoints = [
%     0.157 134.0157 47.384 1;
%     -1.479 102.330 47.751 1;
%     -0.866 66.639 47.692 1;
%     1.370 37.498 48.116 1;
%     ];

%LEGO
RefPoints = [
    -22.7719 29.2857 -61.0594 1;
    -23.9771 -10.7234 -60.8194 1;
    -13.7686 -11.0768 -76.6172 1;
    -12.4593 29.2417 -77.0262 1;
    ];


% Import that registration results

% fCal
% % Landmark
% ReferenceToRASBuffer = [
%     0.0126	0.9994	0.0317	111.8667	-0.9997	0.0132	-0.0206	15.317	-0.021	-0.0314	0.9993	6.5737	0	0	0	1;
%     0.0159	0.9997	0.0184	112.0356	-0.9997	0.0162	-0.0155	15.6672	-0.0158	-0.0182	0.9997	7.0212	0	0	0	1;
%     0.0123	0.9999	0.008	112.3733	-0.9997	0.0125	-0.0224	15.5938	-0.0225	-0.0077	0.9997	8.111	0	0	0	1;
%     0.018	0.9998	0.0058	112.2556	-0.9996	0.0181	-0.0199	15.7537	-0.02	-0.0054	0.9998	7.5442	0	0	0	1;
%     0.0141	0.9997	0.0215	111.8191	-0.9997	0.0145	-0.0179	15.1742	-0.0182	-0.0212	0.9996	7.0342	0	0	0	1;
%     0.0125	0.9999	0.0109	112.1548	-0.9998	0.0127	-0.0161	15.2844	-0.0162	-0.0107	0.9998	7.843	0	0	0	1;
%     0.0155	0.9998	0.0133	112.335	-0.9997	0.0157	-0.0164	15.449	-0.0166	-0.0131	0.9998	7.6499	0	0	0	1;
%     0.0149	0.9997	0.0216	111.9558	-0.9998	0.0152	-0.011	15.2441	-0.0113	-0.0216	0.9997	7.4621	0	0	0	1;
%     0.0165	0.9999	0.0014	112.3004	-0.9998	0.0165	-0.0085	15.4211	-0.0086	-0.0013	1	7.9601	0	0	0	1;
%     0.0104	0.9999	0.012	111.9218	-0.9998	0.0107	-0.0194	15.3332	-0.0195	-0.0118	0.9997	7.4332	0	0	0	1;
%     0.0143	0.9999	0.0093	112.0875	-0.9997	0.0145	-0.0214	15.4296	-0.0215	-0.009	0.9997	7.751	0	0	0	1;
%     0.0169	0.9998	0.0045	112.1282	-0.9997	0.0169	-0.015	15.3939	-0.0151	-0.0042	0.9999	7.9984	0	0	0	1;
%     ];

% % Linear Object Registration
% ReferenceToRASBuffer = [
%     0.0135	0.9999	-0.0082	112.6327	-0.9998	0.0134	-0.0141	15.5876	-0.014	0.0084	0.9999	7.9281	0	0	0	1;
%     0.0092	0.9998	-0.0164	113.042	-0.9998	0.0089	-0.0204	15.8272	-0.0202	0.0165	0.9997	7.8994	0	0	0	1;
%     0.0104	0.9999	-0.0063	112.7645	-0.9999	0.0103	-0.0136	15.535	-0.0136	0.0064	0.9999	7.6181	0	0	0	1;
%     0.0052	0.9997	-0.023	113.0074	-0.9999	0.0049	-0.0131	15.1228	-0.013	0.023	0.9996	8.3101	0	0	0	1;
%     0.007	0.9999	-0.0153	112.3764	-0.9998	0.0067	-0.0163	15.3871	-0.0162	0.0154	0.9998	8.1433	0	0	0	1;
%     0.0048	1	-0.0056	112.6081	-0.9999	0.0047	-0.0121	15.3609	-0.0121	0.0056	0.9999	7.7052	0	0	0	1;
%     0.008	0.9999	-0.012	112.3978	-0.9999	0.0078	-0.01749	15.36	-0.0148	0.0121	0.9998	8.1984	0	0	0	1;
%     0.0054	1	-0.0045	112.3917	-0.9998	0.0053	-0.0188	15.5374	-0.0188	0.0046	0.9998	7.9039	0	0	0	1;
%     0.0115	0.9998	-0.0151	112.5818	-0.9994	0.011	-0.0326	16.0907	-0.0325	0.0154	0.9994	7.8088	0	0	0	1;
%     0.0083	0.9999	-0.0094	112.2172	-0.9999	0.0082	-0.0128	15.4539	-0.0128	0.0095	0.9999	8.2139	0	0	0	1;
%     0.0035	1	-0.0081	112.7198	-0.9999	0.0034	-0.0129	15.3362	-0.0129	0.0081	0.9999	7.9648	0	0	0	1;
%     0.0096	0.9999	-0.0086	112.4506	-0.9999	0.0095	-0.0114	15.3495	-0.0114	0.0087	0.9999	7.8138	0	0	0	1;
%     ];

% Lumbar
% % Landmark
% ReferenceToRASBuffer = [
% -0.0057	0.0049	1	-59.022	1	-0.0031	0.0057	-79.8348	0.0032	1	-0.0049	-32.9376	0	0	0	1;
% -0.0084	-0.0014	1	-58.5912	1	0.0006	0.0084	-80.0948	-0.0006	1	0.0014	-33.2893	0	0	0	1;
% -0.0094	0.0022	1	-59.0598	1	-0.0017	0.0094	-80.0762	0.0018	1	-0.0022	-32.4468	0	0	0	1;
% -0.0089	0.0026	1	-59.1082	1	0.0017	0.0089	-80.1357	-0.0016	1	-0.0027	-32.4947	0	0	0	1;
% -0.0033	-0.0061	1	-59.0748	1	-0.0018	0.0033	-80.0582	0.0018	1	0.0061	-32.8689	0	0	0	1;
% -0.0087	-0.0049	0.9999	-58.4734	1	0.0008	0.0087	-79.9615	-0.0008	1	0.0049	-33.1277	0	0	0	1;
% -0.0052	-0.003	1	-58.6771	1	-0.0027	0.0052	-79.8326	0.0027	1	0.003	-32.5995	0	0	0	1;
% -0.0033	-0.0021	1	-59.022	1	-0.003	0.0033	-79.9923	0.003	1	0.0021	-32.8397	0	0	0	1;
% -0.0001	-0.0032	1	-59.2316	1	-0.0013	0.0001	-79.8739	0.0013	1	0.0032	-32.6787	0	0	0	1;
% ];

% % Linear Object Registration
% ReferenceToRASBuffer = [
% -0.0018	-0.0081	1	-58.9487	1	-0.0005	0.0018	-80.0311	0.0004	1	0.0081	-32.1696	0	0	0	1;
% -0.0174	-0.006	0.9998	-58.0443	0.9998	-0.006	0.0173	-80.0503	0.0065	1	0.0061	-32.6418	0	0	0	1;
% -0.0033	-0.0111	0.9999	-58.0965	1	0.0037	0.0034	-80.2838	-0.0037	0.9999	0.0111	-31.7675	0	0	0	1;
% -0.0099	-0.0096	0.9999	-57.944	0.9999	-0.0026	0.0099	-79.8959	0.0025	1	0.0096	-31.6011	0	0	0	1;
% 0	-0.0191	0.9998	-57.7457	1	0.0023	0	-80.1018	-0.0023	0.9998	0.0191	-31.7594	0	0	0	1;
% -0.0003	-0.0117	0.9999	-58.5343	1	0.0038	0.0003	-79.4101	-0.0038	0.9999	0.0117	-33.2361	0	0	0	1;
% -0.0019	-0.0094	1	-58.3717	0.9999	0.0102	0.002	-81.0807	-0.0102	0.9999	0.0094	-32.7256	0	0	0	1;
% -0.0076	-0.0165	0.9998	-57.7971	1	-0.0026	0.0076	-79.2801	0.0025	0.9999	0.0165	-32.7042	0	0	0	1;
% -0.0013	-0.0153	0.9999	-58.4073	1	0.0028	0.0013	-80.2201	-0.0028	0.9999	0.0153	-32.0327	0	0	0	1;
% ];


% LEGO
% % Landmark
% ReferenceToRASBuffer = [
% 0.0252	-0.0029	-0.9997	-28.6264	-0.0378	-0.9993	0.002	27.7813	-0.999	0.0378	-0.0253	-13.4335	0	0	0	1;
% 0.0251	-0.0017	-0.9997	-28.6184	-0.0445	-0.999	0.0006	27.2759	-0.9987	0.0444	-0.0252	-13.3951	0	0	0	1;
% 0.0219	-0.0021	-0.9998	-28.8376	-0.0414	-0.9991	0.0012	27.4336	-0.9989	0.0413	-0.022	-13.073	0	0	0	1;
% 0.0224	-0.0019	-0.9997	-28.7049	-0.0395	-0.9992	0.001	27.4576	-0.999	0.0394	-0.0225	-12.9915	0	0	0	1;
% 0.0256	-0.0019	-0.9997	-28.5943	-0.0349	-0.9994	0.001	27.6837	-0.9991	0.0348	-0.0257	-13.3484	0	0	0	1;
% 0.0201	-0.0014	-0.9998	-28.7931	-0.035	-0.9994	0.0007	27.6533	-0.9992	0.035	-0.0202	-12.7656	0	0	0	1;
% 0.0208	0.0012	-0.9998	-28.7458	-0.037	-0.9993	-0.002	27.4021	-0.9991	0.037	-0.0208	-12.9641	0	0	0	1;
% 0.0191	-0.0015	-0.9998	-28.8973	-0.0374	-0.9993	0.0008	27.6203	-0.9991	0.0374	-0.0192	-12.8911	0	0	0	1;
% 0.0204	-0.0008	-0.9998	-28.69	-0.04	-0.9992	0	27.5602	-0.999	0.04	-0.0204	-12.7531	0	0	0	1;
% 0.0212	-0.0018	-0.9998	-28.7183	-0.037	-0.9993	0.001	27.7194	-0.9991	0.037	-0.0213	-12.9184	0	0	0	1;
% 0.021	-0.0004	-0.9998	-28.7868	-0.0382	-0.9993	-0.0004	27.4956	-0.9991	0.0382	-0.021	-12.985	0	0	0	1;
% 0.0168	-0.0026	-0.9999	-28.9372	-0.0361	-0.9993	0.002	27.7923	-0.9992	0.0361	-0.0168	-12.5729	0	0	0	1
% ];

% Linear Object Registration
ReferenceToRASBuffer = [
0.0334	-0.0003	-0.9994	-27.8891	-0.036	-0.9994	-0.0009	28.0186	-0.9988	0.036	-0.0334	-14.0296	0	0	0	1;
0.0373	0.0017	-0.9993	-27.9675	-0.0388	-0.9992	-0.0031	28.8584	-0.9985	0.0389	-0.0372	-14.3385	0	0	0	1;
0.0355	0.0035	-0.9994	-27.9994	-0.0394	-0.9992	-0.0049	28.5366	-0.9986	0.0396	-0.0353	-14.2234	0	0	0	1;
0.032	0.0035	-0.9995	-27.7067	-0.037	-0.9993	-0.0047	28.4162	-0.9988	0.0372	-0.0318	-13.8157	0	0	0	1;
0.0309	0.0016	-0.9995	-27.7369	-0.0391	-0.9992	-0.0028	28.4243	-0.9988	0.0392	-0.0308	-14.0762	0	0	0	1;
0.0304	0.0013	-0.9995	-27.849	-0.0368	-0.9993	-0.0025	28.633	-0.9989	0.0369	-0.0304	-13.6291	0	0	0	1;
0.033	-0.0007	-0.9995	-27.9461	-0.0346	-0.9994	-0.0004	28.408	-0.9989	0.0346	-0.033	-13.9169	0	0	0	1;
0.0301	0.0015	-0.9995	-27.8521	-0.0372	-0.9993	-0.0026	28.7713	-0.9989	0.0373	-0.03	-13.7886	0	0	0	1;
0.0333	0.0045	-0.9994	-27.9728	-0.0365	-0.9993	-0.0057	28.6746	-0.9988	0.0366	-0.0331	-13.9021	0	0	0	1;
0.0301	0.0022	-0.9995	-27.8104	-0.039	-0.9992	-0.0034	28.458	-0.9988	0.0391	-0.03	-14.0831	0	0	0	1;
0.0345	0.0084	-0.9994	-27.5802	-0.0406	-0.9991	-0.0098	28.4656	-0.9986	0.0409	-0.0342	-14.3196	0	0	0	1;
0.0337	0.0026	-0.9994	-27.6828	-0.04	-0.9992	-0.0039	28.5427	-0.9986	0.0401	-0.0336	-14.4504	0	0	0	1
];


% Count how many iterations we require
numPoints = size( RasPoints, 1 );
numRegistrations = size( ReferenceToRASBuffer, 1 );

PointDifferences = zeros( numRegistrations, numPoints );

for i = 1:numRegistrations
    
    ReferenceToRASMatrix = reshape( ReferenceToRASBuffer( i, : ), 4, 4 )';
    
    for j = 1:numPoints
        CurrentRasPoint = RasPoints( j, : )';
        CurrentRefPoint = RefPoints( j, : )';
        
        PointEstimate = ReferenceToRASMatrix * CurrentRefPoint;
        PointDifferences( i, j ) = norm( CurrentRasPoint - PointEstimate );
    end
    
end
